# OpenCC 性能基准测试结果

**测试日期**: 2026-01-04
**测试环境**: 16 核 CPU @ 2.6GHz
**构建类型**: RelWithDebInfo
**编译器**: GCC 13.3.0

## 初始化性能

转换器加载时间（各配置文件初始化耗时）：

### 快速初始化 (< 1ms)

| 配置 | 时间 (总计) | 时间 (CPU) | 迭代次数 | 说明 |
|------|------------|-----------|----------|------|
| t2hk | 0.507 ms | 0.486 ms | 1400 | 台湾繁体→香港繁体 |
| tw2t | 0.625 ms | 0.600 ms | 1167 | 台湾繁体→繁体 |
| hk2t | 0.644 ms | 0.607 ms | 1400 | 香港繁体→台湾繁体 |
| t2jp | 0.685 ms | 0.634 ms | 1167 | 繁体→日文新字体 |
| jp2t | 0.827 ms | 0.800 ms | 875 | 日文新字体→繁体 |

### 中等初始化 (1-3ms)

| 配置 | 时间 (总计) | 时间 (CPU) | 迭代次数 | 说明 |
|------|------------|-----------|----------|------|
| t2s | 1.69 ms | 1.62 ms | 437 | 繁体→简体 |
| tw2s | 1.83 ms | 1.72 ms | 389 | 台湾繁体→简体 |
| hk2s | 2.10 ms | 1.69 ms | 467 | 香港繁体→简体 |
| tw2sp | 2.23 ms | 2.16 ms | 333 | 台湾繁体→简体（带短语） |

### 较慢初始化 (30-36ms)

| 配置 | 时间 (总计) | 时间 (CPU) | 迭代次数 | 说明 |
|------|------------|-----------|----------|------|
| s2hk | 34.0 ms | 31.5 ms | 20 | 简体→香港繁体 |
| s2t | 34.1 ms | 30.9 ms | 22 | 简体→繁体 |
| s2tw | 35.1 ms | 33.2 ms | 22 | 简体→台湾繁体 |
| s2twp | 35.8 ms | 33.8 ms | 21 | 简体→台湾繁体（带短语） |

**观察**: 简体→繁体的初始化时间显著长于繁体→简体（约 20 倍），这是因为简体到繁体转换需要加载更大的词典文件以处理一对多映射。

## 转换性能

使用 `s2t` (简体→繁体) 配置测试不同文本长度的转换性能：

| 测试 | 文本长度 | 时间 (总计) | 时间 (CPU) | 迭代次数 | 吞吐量估算 |
|------|---------|------------|-----------|----------|-----------|
| BM_Convert/100 | 100 行 | 0.713 ms | 0.660 ms | 1000 | ~152k 行/秒 |
| BM_Convert/1000 | 1,000 行 | 7.14 ms | 6.60 ms | 100 | ~152k 行/秒 |
| BM_Convert/10000 | 10,000 行 | 76.7 ms | 72.0 ms | 10 | ~139k 行/秒 |
| BM_Convert/100000 | 100,000 行 | 784 ms | 730 ms | 1 | ~137k 行/秒 |
| BM_Convert2M | 左传全文 (2M 字符) | 407 ms | 380 ms | 2 | ~5.3 MB/秒 |

**观察**:
- 转换性能呈现良好的线性扩展性
- 稳定的吞吐量约 140-150k 行/秒
- 大文本转换效率高，2MB 文本仅需约 400ms

## 关键发现

1. **初始化成本差异大**: 简→繁转换初始化需 30-36ms，而繁→简仅需 1.7-2.2ms
2. **转换性能稳定**: 无论文本大小，吞吐量保持在 137-152k 行/秒
3. **适合批处理**: 对于大文本转换，一次初始化成本被摊销，整体性能优异
4. **实时应用考虑**: 对于需要频繁创建转换器的场景，考虑重用转换器实例以避免初始化开销

## 性能优化建议

- **重用转换器实例**: 避免重复初始化，特别是简→繁转换
- **批处理**: 累积文本后批量转换，减少初始化开销占比
- **按需选择配置**: 根据实际需求选择最简配置（如不需要地区词汇可选择基础配置）
- **预加载**: 在应用启动时预初始化常用转换器

## 测试命令

```bash
make benchmark
```

构建配置：
```cmake
-DENABLE_BENCHMARK:BOOL=ON
-DCMAKE_BUILD_TYPE=RelWithDebInfo
```
